## LCA

–ó–∞–¥–∞–Ω–æ –¥–µ—Ä–µ–≤–æ —Å –∫–æ—Ä–Ω–µ–º, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ `n` (1 ‚â§ ùëõ ‚â§ 100 000) –≤–µ—Ä—à–∏–Ω, –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç `0` –¥–æ `n‚àí1`. –¢—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ `m` (1 ‚â§ m ‚â§ 10 000 000) –∑–∞–ø—Ä–æ—Å–æ–≤ –æ –Ω–∞–∏–º–µ–Ω—å—à–µ–º –æ–±—â–µ–º –ø—Ä–µ–¥–∫–µ –¥–ª—è –ø–∞—Ä—ã –≤–µ—Ä—à–∏–Ω. –ó–∞–ø—Ä–æ—Å—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º. –ó–∞–¥–∞–Ω—ã —á–∏—Å–ª–∞ `a_1`, `a_2` –∏ —á–∏—Å–ª–∞ `x`, `y` –∏ `z`. –ß–∏—Å–ª–∞ `a_3`, . . . , `a_2m` –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º: `a_i  = (xa_i‚àí2+y¬∑a_i‚àí1+z) mod n`. –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å –∏–º–µ–µ—Ç –≤–∏–¥ `‚ü®a_1, a_2‚ü©`. –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –Ω–∞ ùëñ‚àí1-–π –∑–∞–ø—Ä–æ—Å —Ä–∞–≤–µ–Ω `v`, —Ç–æ ùëñ-–π –∑–∞–ø—Ä–æ—Å –∏–º–µ–µ—Ç –≤–∏–¥ `‚ü®(a_2i‚àí1 + v) mod n, a_2i‚ü©`.

–î–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ –¥–≤–æ–∏—á–Ω–æ–≥–æ –ø–æ–¥—ä—ë–º–∞.

*–§–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.*

–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ —á–∏—Å–ª–∞: `n` –∏ `m`. –ö–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ –∏–º–µ–µ—Ç –Ω–æ–º–µ—Ä 0.
–í—Ç–æ—Ä–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç ùëõ ‚àí 1 —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª, ùëñ-–µ –∏–∑ —ç—Ç–∏—Ö —á–∏—Å–µ–ª —Ä–∞–≤–Ω–æ –Ω–æ–º–µ—Ä—É —Ä–æ–¥–∏—Ç–µ–ª—è –≤–µ—Ä—à–∏–Ω—ã ùëñ.
–¢—Ä–µ—Ç—å—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–≤–∞ —Ü–µ–ª—ã—Ö —á–∏—Å–ª–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 0 –¥–æ ùëõ‚àí1: ùëé1 –∏ ùëé2.
–ß–µ—Ç–≤–µ—Ä—Ç–∞—è —Å—Ç—Ä–æ–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç—Ä–∏ —Ü–µ–ª—ã—Ö —á–∏—Å–ª–∞: ùë•, ùë¶ –∏ ùëß, —ç—Ç–∏ —á–∏—Å–ª–∞ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã –∏ –Ω–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—Ç 109.

*–§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.*

–í—ã–≤–µ–¥–∏—Ç–µ –≤ –≤—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª —Å—É–º–º—É –Ω–æ–º–µ—Ä–æ–≤ –≤–µ—Ä—à–∏–Ω ‚Äî –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã.

In:
```
3 2
0 1
2 1
1 1 0
```
Out:
```
2
```
